{"name":"lsd-opencv-matlab","tagline":"Line Segment Detector for OpenCV and MATLAB","body":"###1. Introduction\r\nLSD-OpenCV-MATLAB is toolbox of Line Segment Detector(LSD) for OpenCV and MATLAB, as part of the GSoC 2013 program. The original code and paper, developed by Rafael Grompone von Gioi, can be found at http://www.ipol.im/pub/art/2012/gjmr-lsd/.\r\n\r\n#####Please feel free to contact me [tanggefu@gmail.com] if you have any questions.\r\n\r\n###2. Compilation\r\n\r\nLSD is written by C++. And it also can be easily used in many contexts through the MATLAB bindings provided with this toolbox.\r\n\r\nIf you want to test or contribute, [CMAKE](http://www.cmake.org), a cross-platform, open-source build system, is usded to build some tools for the purpose. CMake can be downloaded from [CMake' website](http://www.cmake.org/cmake/resources/software.html).\r\n\r\nThe compilation rely on [OpenCV](http://opencv.org) - A cross-platform open source computer vision library.\r\n\r\nDuring compilation, create a new directory named `build` in the main directory, then choose a appropriate compiler and switch to the `build` directory, finally, execute the following command according to your machine:\r\n\r\n* Windows\r\n\r\n```cpp\r\ncmake -DCMAKE_BUILD_TYPE=Release .. -G\"NMake Makefiles\"\r\nnmake\r\n```\r\n\r\n* Linux\r\n\r\n```cpp\r\ncmake ..\r\nmake\r\n```\r\n\r\nIf successful, this should create two files named lsd.xxx and lsd_image.xxx in `./build/matlab/`, where xxx is a suffix that depends on what machine you are on.\r\n\r\n###3. Usage\r\n\r\n* C++/OpenCV\r\n\r\nTo test LSD algorithm with OpenCV, run `./build/lsd_opencv_example.exe` after compilation.\r\n\r\n```cpp\r\n/**\r\n * @file lsd_opencv_example.cpp\r\n *\r\n * Test the LSD algorithm with OpenCV\r\n */\r\n#include <highgui.h>\r\n#include <cv.h>\r\n#include <lsd.h>\r\n\r\nint main(int argc, char **argv)\r\n{\r\n    cv::Mat src = cv::imread(\"./../../images/test.jpg\", CV_LOAD_IMAGE_COLOR);\r\n    cv::Mat tmp, src_gray;\r\n    cv::cvtColor(src, tmp, CV_RGB2GRAY);\r\n    tmp.convertTo(src_gray, CV_64FC1);\r\n\r\n    int cols  = src_gray.cols;\r\n    int rows = src_gray.rows;\r\n\r\n    image_double image = new_image_double(cols, rows);\r\n    image->data = src_gray.ptr<double>(0);\r\n    ntuple_list ntl = lsd(image);\r\n\r\n    cv::Mat lsd = cv::Mat::zeros(rows, cols, CV_8UC1);\r\n\r\n    for (int j = 0; j != ntl->size ; ++j)\r\n    {\r\n        cv::Point pt1, pt2;\r\n        pt1.x = ntl->values[0 + j * ntl->dim];\r\n        pt1.y = ntl->values[1 + j * ntl->dim];\r\n        pt2.x = ntl->values[2 + j * ntl->dim];\r\n        pt2.y = ntl->values[3 + j * ntl->dim];\r\n        cv::line(lsd, pt1, pt2, cv::Scalar(255), 1, CV_AA);\r\n    }\r\n    free_ntuple_list(ntl);\r\n\r\n    cv::namedWindow(\"src\", CV_WINDOW_AUTOSIZE);\r\n    cv::imshow(\"src\", src);\r\n    cv::namedWindow(\"lsd\", CV_WINDOW_AUTOSIZE);\r\n    cv::imshow(\"lsd\", lsd);\r\n    cv::waitKey(0);\r\n    cv::destroyAllWindows();\r\n}\r\n```\r\n\r\n* MATLAB\r\n\r\nTo test LSD algorithm with MATLAB, run `./matlab/x64(x86)/lsd_example.m` and `./matlab/x64(x86)/lsd2_example.m`, if your platform is x86, you should compile the corresponding `xxx.mexw32` files by Cmake.\r\n\r\n\r\n```matlab\r\n% lsd_example.m\r\n% Test LSD algorithm with MATLAB\r\n%% show the image.\r\nim = imread('./images/test.jpg');\r\nimshow(im);\r\n%% get the start_points and end_points of each straight line use LSD.\r\n% note: input parameter is the path of image, use '/' as file separator.\r\npoints = lsd('./images/test.jpg');\r\n%% plot the lines.\r\nhold on;\r\nfor i = 1:size(points, 2)\r\n    plot(points(1:2, i), points(3:4, i),'LineWidth', 2, 'Color', [1, 0, 0]);\r\nend\r\n```\r\n\r\n```matlab\r\n% lsd2_example.m\r\n% Test LSD algorithm with MATLAB\r\n%% show the image.\r\nim = imread('./images/test.jpg');\r\nimshow(im);\r\n%% show the binary image after the process of LSD.\r\n% note: input parameter is the path of image, use '/' as file separator.\r\nfigure;\r\nimshow(lsd2('./images/test.jpg'));\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}